<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Maria Elisa Rocha Couto Gomes" />


<title>Relatório final do curso “R para Ciência de Dados II”</title>

<script src="RelatórioFinalMariaElisa_files/header-attrs-2.11/header-attrs.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

/* A workaround for https://github.com/jgm/pandoc/issues/4278 */
a.sourceLine {
  pointer-events: auto;
}

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link rel="stylesheet" href="RelatórioFinalMariaElisa_files/style.css" type="text/css" />





</head>

<body>




<div class="entry-header">
  <div class="entry-image">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->
<div id="main" role="main">
<article class="hentry">
<header class="header-title">
<div class="header-title-wrap">
<h1 class="title toc-ignore entry-title">Relatório final do curso “R para Ciência de Dados II”</h1>
<h3 class="author">Maria Elisa Rocha Couto Gomes</h3>
</div><!-- /.header-title-wrap -->
</header>


<div class="entry-content">

<div style="text-align: justify">
<p>Antes de responder às perguntas propostas, é necessário, primeiramente, conectar este projeto ao GitHub e, em segundo lugar, importar os bancos de dados a serem utilizados durante a elaboração deste relatório.</p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conectando o GitHub</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_git</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">use_github</span>()</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalando pacote &quot;basesCursoR&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;curso-r/basesCursoR&quot;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>imdb_completa <span class="ot">&lt;-</span> basesCursoR<span class="sc">::</span><span class="fu">pegar_base</span>(<span class="st">&quot;imdb_completa&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>imdb_pessoas <span class="ot">&lt;-</span> basesCursoR<span class="sc">::</span><span class="fu">pegar_base</span>(<span class="st">&quot;imdb_pessoas&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>imdb_avaliacoes <span class="ot">&lt;-</span> basesCursoR<span class="sc">::</span><span class="fu">pegar_base</span>(<span class="st">&quot;imdb_avaliacoes&quot;</span>)</span></code></pre></div>
<div style="text-align: justify">
<p>Uma vez que os bancos de dados já foram importantos, os salvarei.</p>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os bancos de dados originais</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv2</span>(imdb_completa, <span class="st">&quot;data_raw/imdb_completa.csv&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv2</span>(imdb_avaliacoes, <span class="st">&quot;data_raw/imdb_avaliacoes.csv&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv2</span>(imdb_pessoas, <span class="st">&quot;data_raw/imdb_pessoas.csv&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando os bancos de dados em formato rds</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(imdb_completa, <span class="st">&quot;data/imdb_completa.rds&quot;</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(imdb_avaliacoes, <span class="st">&quot;data/imdb_avaliacoes.rds&quot;</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(imdb_pessoas, <span class="st">&quot;data/imdb_pessoas.rds&quot;</span>)</span></code></pre></div>
<div style="text-align: justify">
<p>Agora sim, responderei às perguntas.</p>
<p><strong>1. Qual o mês do ano com o maior númedo de filmes? E o dia do ano?</strong></p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando os pacotes necessários para responder à pergunta:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.5     v dplyr   1.0.7
## v tidyr   1.1.4     v stringr 1.4.0
## v readr   2.0.2     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando qual mês teve o maior número de filmes:</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>recorde_filme_mes <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data_config =</span> <span class="fu">as.Date</span>(<span class="fu">ymd</span>(data_lancamento))) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(mês <span class="ot">=</span> <span class="fu">month</span>(data_config)) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(mês, ano), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(mês<span class="at">_ano =</span> <span class="fu">paste</span>(mês, ano, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mês_ano) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_filmes =</span> <span class="fu">n_distinct</span>(titulo)) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(mês_ano, n_filmes) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_filmes)) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pos =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Posição&quot;</span> <span class="ot">=</span> pos, <span class="st">&quot;Mês/Ano&quot;</span> <span class="ot">=</span> mês_ano, <span class="st">&quot;Número de lançamentos&quot;</span> <span class="ot">=</span> n_filmes) <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 1 - Mês com maior número de lançamentos&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 4563 failed to parse.</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando qual dia teve o maior número de filmes:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>recorde_filme_dia <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data_config =</span> <span class="fu">as.Date</span>(<span class="fu">ymd</span>(data_lancamento))) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(mês <span class="ot">=</span> <span class="fu">month</span>(data_config)) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dia =</span> <span class="fu">day</span>(data_config)) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(dia, mês, ano), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(dia_mês<span class="at">_ano =</span> <span class="fu">paste</span>(dia, mês, ano, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dia_mês_ano) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_filmes =</span> <span class="fu">n_distinct</span>(titulo)) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(dia_mês_ano, n_filmes) <span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_filmes)) <span class="sc">%&gt;%</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pos =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Posição&quot;</span> <span class="ot">=</span> pos, <span class="st">&quot;Dia/Mês/Ano&quot;</span> <span class="ot">=</span> dia_mês_ano, <span class="st">&quot;Número de Lançamentos&quot;</span> <span class="ot">=</span> n_filmes) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 2 - Dia com maior número de lançamentos&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 4563 failed to parse.</code></pre>
<div style="text-align: justify">
<p>O mês com maior número de lançamentos de filmes foi:</p>
<table>
<caption>
Tabela 1 - Mês com maior número de lançamentos
</caption>
<thead>
<tr>
<th style="text-align:center;">
Posição
</th>
<th style="text-align:center;">
Mês/Ano
</th>
<th style="text-align:center;">
Número de lançamentos
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
10/2018
</td>
<td style="text-align:center;">
386
</td>
</tr>
</tbody>
</table>
</div>
<div style="text-align: justify">
<p>O dia com maior número de lançamentos de filmes foi:</p>
<table>
<caption>
Tabela 2 - Dia com maior número de lançamentos
</caption>
<thead>
<tr>
<th style="text-align:center;">
Posição
</th>
<th style="text-align:center;">
Dia/Mês/Ano
</th>
<th style="text-align:center;">
Número de Lançamentos
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
26/10/2018
</td>
<td style="text-align:center;">
46
</td>
</tr>
</tbody>
</table>
</div>
<div style="text-align: justify">
<p><strong>2. Qual o top 5 países com mais filmes na base?</strong></p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificando o top 5 países com mais filmes na base IMDB:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>top_paises_filmes <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pais)) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pais_nova =</span> <span class="fu">str_split</span>(pais, <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pais_nova) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pais_nova) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_filmes_pais =</span> <span class="fu">n_distinct</span>(titulo)) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(pais_nova, n_filmes_pais) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_filmes_pais)) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;pos&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Posição&quot;</span> <span class="ot">=</span> pos, <span class="st">&quot;País&quot;</span> <span class="ot">=</span> pais_nova, <span class="st">&quot;Número de filmes&quot;</span> <span class="ot">=</span> n_filmes_pais) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 3 - País com maior número de filmes&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span></code></pre></div>
<div style="text-align: justify">
<p>Na Tabela 3, é possível observar o top cinco países com maior número de filmes na base de dados IMDB:</p>
<table>
<caption>
Tabela 3 - País com maior número de filmes
</caption>
<thead>
<tr>
<th style="text-align:center;">
Posição
</th>
<th style="text-align:center;">
País
</th>
<th style="text-align:center;">
Número de filmes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
USA
</td>
<td style="text-align:center;">
33133
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
France
</td>
<td style="text-align:center;">
8224
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
UK
</td>
<td style="text-align:center;">
7379
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
India
</td>
<td style="text-align:center;">
6123
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
Italy
</td>
<td style="text-align:center;">
5012
</td>
</tr>
</tbody>
</table>
</div>
<div style="text-align: justify">
<p><strong>3. Liste todas as moedas que aparecem nas colunas <code>orcamento</code> e <code>receita</code> da base <code>imdb_completa</code>.</strong></p>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando pacotes que utilizarei para responder a esta pergunta:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificando quais são as moedas dos orçamentos e das receitas dos filmes contidos na base IMDB:</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>moedas_receita_orcamento <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(orcamento, receita), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento, receita),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_extract</span>((.x), <span class="at">pattern =</span> <span class="fu">c</span>(<span class="st">&quot;^.[[:blank:][:digit:]]&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">X+?[[:blank:][:digit:]]&quot;</span>))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(orcamento, receita), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento, receita),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_replace_all</span>((.x), <span class="at">pattern =</span> <span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Importando banco de dados que contém mais informações sobre as moedas que foram identificadas:</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>lista_moedas <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;D:/GitHub/RelatorioFinal2/data_raw/lista_moedas.xlsx&quot;</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Listando as moedas dos orçamentos dos filmes contidos na base IMDB:</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>moedas_orcamento <span class="ot">&lt;-</span> moedas_receita_orcamento <span class="sc">%&gt;%</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(orcamento) <span class="sc">%&gt;%</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">orcamento =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    orcamento <span class="sc">==</span> <span class="st">&quot;$&quot;</span> <span class="sc">~</span> <span class="st">&quot;USD&quot;</span>,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="fu">as.character</span>(orcamento))</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(lista_moedas, <span class="at">by =</span> <span class="st">&quot;orcamento&quot;</span>, <span class="at">copy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Código das moedas dos orçamentos dos filmes&quot;</span> <span class="ot">=</span> orcamento, <span class="st">&quot;Nome da moeda&quot;</span> <span class="ot">=</span> nome) <span class="sc">%&gt;%</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 4 - Moedas dos orçamentos dos filmes&quot;</span>, <span class="at">align =</span> <span class="st">&quot;cc&quot;</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Listando as moedas das receitas dos filmes contidos na base IMDB:</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>moedas_receita <span class="ot">&lt;-</span> moedas_receita_orcamento <span class="sc">%&gt;%</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(receita) <span class="sc">%&gt;%</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">receita =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    receita <span class="sc">==</span> <span class="st">&quot;$&quot;</span> <span class="sc">~</span> <span class="st">&quot;USD&quot;</span>,</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="fu">as.character</span>(receita))</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(lista_moedas, <span class="at">by =</span> <span class="st">&quot;receita&quot;</span>, <span class="at">copy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Código das moedas das receitas dos filmes&quot;</span> <span class="ot">=</span> receita, <span class="st">&quot;Nome da moeda&quot;</span> <span class="ot">=</span> nome) <span class="sc">%&gt;%</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 5 - Moedas das receitas dos filmes&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span></code></pre></div>
<div style="text-align: justify">
<p>Eis a lista de moedas dos orçamentos dos filmes:</p>
<table>
<caption>
Tabela 4 - Moedas dos orçamentos dos filmes
</caption>
<thead>
<tr>
<th style="text-align:center;">
Código das moedas dos orçamentos dos filmes
</th>
<th style="text-align:center;">
Nome da moeda
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
USD
</td>
<td style="text-align:center;">
Dolar dos Estados Unidos
</td>
</tr>
<tr>
<td style="text-align:center;">
AED
</td>
<td style="text-align:center;">
Dirham dos Emirados Árabes Unidos
</td>
</tr>
<tr>
<td style="text-align:center;">
ARS
</td>
<td style="text-align:center;">
Peso argentino
</td>
</tr>
<tr>
<td style="text-align:center;">
ATS
</td>
<td style="text-align:center;">
Xelim austríaco
</td>
</tr>
<tr>
<td style="text-align:center;">
AUD
</td>
<td style="text-align:center;">
dólar australiano
</td>
</tr>
<tr>
<td style="text-align:center;">
BDT
</td>
<td style="text-align:center;">
Taka de Bangladesh
</td>
</tr>
<tr>
<td style="text-align:center;">
BGL
</td>
<td style="text-align:center;">
Antigo Lev Búlgaro
</td>
</tr>
<tr>
<td style="text-align:center;">
BND
</td>
<td style="text-align:center;">
Dólar do Brunei
</td>
</tr>
<tr>
<td style="text-align:center;">
BRL
</td>
<td style="text-align:center;">
Real brasileiro
</td>
</tr>
<tr>
<td style="text-align:center;">
CAD
</td>
<td style="text-align:center;">
Dólar canadense
</td>
</tr>
<tr>
<td style="text-align:center;">
CHF
</td>
<td style="text-align:center;">
Franco suíço
</td>
</tr>
<tr>
<td style="text-align:center;">
CLP
</td>
<td style="text-align:center;">
Peso chileno
</td>
</tr>
<tr>
<td style="text-align:center;">
CNY
</td>
<td style="text-align:center;">
Yuan chinês
</td>
</tr>
<tr>
<td style="text-align:center;">
CZK
</td>
<td style="text-align:center;">
Coroa tcheca
</td>
</tr>
<tr>
<td style="text-align:center;">
DEM
</td>
<td style="text-align:center;">
Marco alemão
</td>
</tr>
<tr>
<td style="text-align:center;">
DKK
</td>
<td style="text-align:center;">
Coroa dinamarquesa
</td>
</tr>
<tr>
<td style="text-align:center;">
DOP
</td>
<td style="text-align:center;">
Peso dominicano
</td>
</tr>
<tr>
<td style="text-align:center;">
EEK
</td>
<td style="text-align:center;">
Coroa estoniana
</td>
</tr>
<tr>
<td style="text-align:center;">
EGP
</td>
<td style="text-align:center;">
libra egípcia
</td>
</tr>
<tr>
<td style="text-align:center;">
ESP
</td>
<td style="text-align:center;">
Peseta
</td>
</tr>
<tr>
<td style="text-align:center;">
EUR
</td>
<td style="text-align:center;">
Euro
</td>
</tr>
<tr>
<td style="text-align:center;">
FIM
</td>
<td style="text-align:center;">
Marco finlandês
</td>
</tr>
<tr>
<td style="text-align:center;">
FRF
</td>
<td style="text-align:center;">
Franco francês
</td>
</tr>
<tr>
<td style="text-align:center;">
GBP
</td>
<td style="text-align:center;">
Libra britânica
</td>
</tr>
<tr>
<td style="text-align:center;">
HKD
</td>
<td style="text-align:center;">
dólar de Hong Kong
</td>
</tr>
<tr>
<td style="text-align:center;">
HUF
</td>
<td style="text-align:center;">
Forint húngaro
</td>
</tr>
<tr>
<td style="text-align:center;">
IDR
</td>
<td style="text-align:center;">
Rupia indonésia
</td>
</tr>
<tr>
<td style="text-align:center;">
INR
</td>
<td style="text-align:center;">
Rupia indiana
</td>
</tr>
<tr>
<td style="text-align:center;">
IRR
</td>
<td style="text-align:center;">
Rial iraniano
</td>
</tr>
<tr>
<td style="text-align:center;">
ISK
</td>
<td style="text-align:center;">
Coroa islandesa
</td>
</tr>
<tr>
<td style="text-align:center;">
ITL
</td>
<td style="text-align:center;">
Liras italianas
</td>
</tr>
<tr>
<td style="text-align:center;">
JPY
</td>
<td style="text-align:center;">
Yen japonês
</td>
</tr>
<tr>
<td style="text-align:center;">
KRW
</td>
<td style="text-align:center;">
Won sul-coreano
</td>
</tr>
<tr>
<td style="text-align:center;">
LTL
</td>
<td style="text-align:center;">
Litas lituânias
</td>
</tr>
<tr>
<td style="text-align:center;">
LVL
</td>
<td style="text-align:center;">
Lats letão
</td>
</tr>
<tr>
<td style="text-align:center;">
MXN
</td>
<td style="text-align:center;">
Peso mexicano
</td>
</tr>
<tr>
<td style="text-align:center;">
MYR
</td>
<td style="text-align:center;">
Ringgit da Malásia
</td>
</tr>
<tr>
<td style="text-align:center;">
NGN
</td>
<td style="text-align:center;">
Naira nigeriana
</td>
</tr>
<tr>
<td style="text-align:center;">
NOK
</td>
<td style="text-align:center;">
Coroa norueguesa
</td>
</tr>
<tr>
<td style="text-align:center;">
NZD
</td>
<td style="text-align:center;">
Dólar neozelandês
</td>
</tr>
<tr>
<td style="text-align:center;">
PHP
</td>
<td style="text-align:center;">
Peso filipino
</td>
</tr>
<tr>
<td style="text-align:center;">
PKR
</td>
<td style="text-align:center;">
Rupia paquistanesa
</td>
</tr>
<tr>
<td style="text-align:center;">
PLN
</td>
<td style="text-align:center;">
Zloty polonês
</td>
</tr>
<tr>
<td style="text-align:center;">
RUR
</td>
<td style="text-align:center;">
Rublo russo
</td>
</tr>
<tr>
<td style="text-align:center;">
SEK
</td>
<td style="text-align:center;">
Coroa sueca
</td>
</tr>
<tr>
<td style="text-align:center;">
SGD
</td>
<td style="text-align:center;">
dólar de Singapura
</td>
</tr>
<tr>
<td style="text-align:center;">
SKK
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
THB
</td>
<td style="text-align:center;">
Baht tailandês
</td>
</tr>
<tr>
<td style="text-align:center;">
TRL
</td>
<td style="text-align:center;">
Lira turca
</td>
</tr>
<tr>
<td style="text-align:center;">
TWD
</td>
<td style="text-align:center;">
Novo dólar taiwanês
</td>
</tr>
<tr>
<td style="text-align:center;">
UAH
</td>
<td style="text-align:center;">
Hryvnia ucraniana
</td>
</tr>
<tr>
<td style="text-align:center;">
VEB
</td>
<td style="text-align:center;">
Bolívar venezuelano
</td>
</tr>
<tr>
<td style="text-align:center;">
YUM
</td>
<td style="text-align:center;">
Dinar iugoslavo
</td>
</tr>
<tr>
<td style="text-align:center;">
ZAR
</td>
<td style="text-align:center;">
Rand sul-africano
</td>
</tr>
</tbody>
</table>
</div>
<div style="text-align: justify">
<p>E a lista de moedas das receitas dos filmes:</p>
<table>
<caption>
Tabela 5 - Moedas das receitas dos filmes
</caption>
<thead>
<tr>
<th style="text-align:center;">
Código das moedas das receitas dos filmes
</th>
<th style="text-align:center;">
Nome da moeda
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
USD
</td>
<td style="text-align:center;">
Dolar dos Estados Unidos
</td>
</tr>
</tbody>
</table>
</div>
<div style="text-align: justify">
<p><strong>4. Considerando apenas orçamentos e receitas em dólar ($), qual o gênero com maior lucro? E com maior nota média?</strong></p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificando qual é o gênero do filme que teve o maior lucro</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>genero_maior_lucro <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(orcamento, receita), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.), <span class="sc">~</span> <span class="fu">str_detect</span>((.x), <span class="at">pattern =</span> <span class="st">&quot;^.[[:blank:][:digit:]]&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento, receita),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="fu">c</span>(<span class="sc">~</span> <span class="fu">str_extract</span>((.x), <span class="at">pattern =</span> <span class="st">&quot;.[[:digit:]]+!*&quot;</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento_1, receita_1),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lucro =</span> receita_1 <span class="sc">-</span> orcamento_1) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(genero, lucro), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">genero =</span> <span class="fu">str_split</span>(genero, <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(genero) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(titulo, genero, lucro) <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lucro)) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>, lucro) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Título&quot;</span> <span class="ot">=</span> titulo, <span class="st">&quot;Gênero&quot;</span> <span class="ot">=</span> genero, <span class="st">&quot;Lucro&quot;</span> <span class="ot">=</span> lucro) <span class="sc">%&gt;%</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 6 - Gênero do filme com maior lucro&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificando qual é o gênero do filme que obteve a maior nota média</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>genero_maior_nota <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(imdb_avaliacoes, <span class="at">by =</span> <span class="st">&quot;id_filme&quot;</span>, <span class="at">copy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(genero, nota_media), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">genero =</span> <span class="fu">str_split</span>(genero, <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(genero) <span class="sc">%&gt;%</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(titulo, genero, nota_media) <span class="sc">%&gt;%</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(nota_media)) <span class="sc">%&gt;%</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>, nota_media) <span class="sc">%&gt;%</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Título&quot;</span> <span class="ot">=</span> titulo, <span class="st">&quot;Gênero&quot;</span> <span class="ot">=</span> genero, <span class="st">&quot;Nota média&quot;</span> <span class="ot">=</span> nota_media) <span class="sc">%&gt;%</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 7 - Gênero do filme com maior nota média&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span></code></pre></div>
<div style="text-align: justify">
<p>O gênero do filme com maior lucro foi:</p>
<table>
<caption>
Tabela 6 - Gênero do filme com maior lucro
</caption>
<thead>
<tr>
<th style="text-align:center;">
Título
</th>
<th style="text-align:center;">
Gênero
</th>
<th style="text-align:center;">
Lucro
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Avatar
</td>
<td style="text-align:center;">
Action
</td>
<td style="text-align:center;">
2553439092
</td>
</tr>
</tbody>
</table>
</div>
<div style="text-align: justify">
<p>O gênero do filme com maior nota média foi:</p>
<table>
<caption>
Tabela 7 - Gênero do filme com maior nota média
</caption>
<thead>
<tr>
<th style="text-align:center;">
Título
</th>
<th style="text-align:center;">
Gênero
</th>
<th style="text-align:center;">
Nota média
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Lejos de Casa pelicula Venezolana
</td>
<td style="text-align:center;">
Drama
</td>
<td style="text-align:center;">
9.8
</td>
</tr>
</tbody>
</table>
</div>
<div style="text-align: justify">
<p><strong>5. Dentre os filmes na base <code>imdb_completa</code>, escolha o seu favorito. Então faça os itens a seguir:</strong></p>
<p>Meu filme favorito é o musical “Hair”. Se você nunca o assistiu, recomendo que assista ao clipe da música “The Flesh Failures”, mas <strong>atenção</strong>, este vídeo <strong>contém spoilers</strong>:</p>
<iframe style="display: block; margin: auto;" width="560" height="315" src="https://www.youtube.com/embed/NaAC9vDFozc" frameborder="0" gesture="media" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
<p><strong>OBS.:</strong> Esta é a última cena do filme e, por coincidência, a minha preferida. Como costumava vê-lo com minha família quando era criança, demorei muito tempo para entender os sentimentos envolvidos neste. Desde que supostamente os entendi, vejo esta cena com alguma frequência.</p>
</div>
<p><strong>a) Quem dirigiu o filme? Faça uma ficha dessa pessoa: idade (hoje em dia ou data de falecimento), onde nasceu, quantos filmes já dirigiu, qual o lucro médio dos filmes que dirigiu (considerando apenas valores em dólar) e outras informações que achar interessante (base <code>imdb_pessoas</code>).</strong> :::</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando qual é o nome do diretor do filme</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>hair_nome_direcao <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="at">pattern =</span> <span class="st">&quot;Hair$&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(direcao)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando a idade que o diretor de &quot;Hair&quot; tinha quando faleceu</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>milos_idade_falecimento <span class="ot">&lt;-</span> imdb_pessoas <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(nome, <span class="at">pattern =</span> <span class="st">&quot;Milos Forman&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(data_nascimento, data_falecimento),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.Date</span>(<span class="fu">ymd</span>(.))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">idade_falecimento =</span> <span class="fu">as.period</span>(data_falecimento <span class="sc">-</span> data_nascimento) <span class="sc">/</span> <span class="fu">years</span>(<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idade_falecimento =</span> <span class="fu">round</span>(idade_falecimento, <span class="dv">0</span>))</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando quantos filmes, além de &quot;Hair&quot;, ele dirigiu</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>milos_n_filmes <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(direcao, <span class="at">pattern =</span> <span class="st">&quot;Milos Forman&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="at">pattern =</span> <span class="st">&quot;Hair$&quot;</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_filmes =</span> <span class="fu">n_distinct</span>(titulo))</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando os lucros médios dos filmes dirigidos por Milos Forman</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>milos_lucro_medio <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(direcao, <span class="at">pattern =</span> <span class="st">&quot;Milos Forman&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(receita, orcamento), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.), <span class="fu">str_detect</span>((.x), <span class="at">pattern =</span> <span class="st">&quot;^.[[:blank:][:digit:]]&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento, receita),</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> (<span class="fu">str_extract</span>((.x), <span class="at">pattern =</span> <span class="st">&quot;.[[:digit:]]+!*&quot;</span>))</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento, receita),</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lucro =</span> receita <span class="sc">-</span> orcamento) <span class="sc">%&gt;%</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">lucro_medio =</span> <span class="fu">mean</span>(lucro))</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Informações sobre Milos Forman</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>info_milos_forman <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">c</span>(hair_nome_direcao, milos_n_filmes, milos_lucro_medio, milos_idade_falecimento))</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>ficha_info_milos <span class="ot">&lt;-</span> info_milos_forman <span class="sc">%&gt;%</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Nome do diretor&quot;</span> <span class="ot">=</span> direcao, <span class="st">&quot;Número de filmes que dirigiu&quot;</span> <span class="ot">=</span> n_filmes, <span class="st">&quot;Lucro médio&quot;</span> <span class="ot">=</span> lucro_medio, <span class="st">&quot;Idade de falecimento&quot;</span> <span class="ot">=</span> idade_falecimento) <span class="sc">%&gt;%</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Informações gerais sobre o diretor do filme </span><span class="sc">\&quot;</span><span class="st">Hair</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">align =</span> <span class="st">&quot;cccc&quot;</span>)</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>ficha_info_milos</span></code></pre></div>
<table>
<caption>
Informações gerais sobre o diretor do filme “Hair”
</caption>
<thead>
<tr>
<th style="text-align:center;">
Nome do diretor
</th>
<th style="text-align:center;">
Número de filmes que dirigiu
</th>
<th style="text-align:center;">
Lucro médio
</th>
<th style="text-align:center;">
Idade de falecimento
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Milos Forman
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
3099005
</td>
<td style="text-align:center;">
86
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando a frequência relativa de cada um dos gêneros dos filmes que Milos Forman dirigiu</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>milos_generos_freq <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(direcao, <span class="at">pattern =</span> <span class="st">&quot;Milos Forman&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">genero =</span> <span class="fu">str_split</span>(genero, <span class="at">pattern =</span> <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(genero) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genero) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq_genero =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq_genero =</span> freq_genero <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq_genero =</span> <span class="fu">round</span>(freq_genero, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(freq_genero)) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Gênero&quot;</span> <span class="ot">=</span> genero, <span class="st">&quot;Frequência relativa&quot;</span> <span class="ot">=</span> freq_genero) <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 8 - Distribuição da frequência relativa dos gêneros dos filmes que Milos Forman dirigiu&quot;</span>, <span class="at">align =</span> <span class="st">&quot;cc&quot;</span>)</span></code></pre></div>
<div style="text-align: justify">
<p><strong>b) Qual a posição desse filme no ranking de notas do IMDB? E no ranking de lucro (considerando apenas valores em dólar)?</strong></p>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando a posição de &quot;Hair&quot; no ranking de notas do IMDB</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>posicao_nota_hair <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(imdb_avaliacoes, <span class="at">by =</span> <span class="st">&quot;id_filme&quot;</span>, <span class="at">copy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nota_media) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(nota_media)) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;pos&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="at">pattern =</span> <span class="st">&quot;Hair$&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Filme&quot;</span> <span class="ot">=</span> titulo, <span class="st">&quot;Nota média&quot;</span> <span class="ot">=</span> nota_media, <span class="st">&quot;Posição&quot;</span> <span class="ot">=</span> pos) <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 9 - Posição do filme </span><span class="sc">\&quot;</span><span class="st">Hair</span><span class="sc">\&quot;</span><span class="st"> no ranking de notas médias das avaliações&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>posicao_nota_hair</span></code></pre></div>
<table>
<caption>
Tabela 9 - Posição do filme “Hair” no ranking de notas médias das avaliações
</caption>
<thead>
<tr>
<th style="text-align:center;">
Filme
</th>
<th style="text-align:center;">
Nota média
</th>
<th style="text-align:center;">
Posição
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Hair
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
5735
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando a posição de &quot;Hair&quot; no ranking de notas do IMDB</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>posicao_lucro_hair <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(receita, orcamento), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.), <span class="fu">str_detect</span>((.x), <span class="at">pattern =</span> <span class="st">&quot;^.[[:blank:][:digit:]]&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento, receita),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> (<span class="fu">str_extract</span>((.x), <span class="at">pattern =</span> <span class="st">&quot;.[[:digit:]]+!*&quot;</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="fu">c</span>(orcamento, receita),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lucro =</span> receita <span class="sc">-</span> orcamento) <span class="sc">%&gt;%</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lucro) <span class="sc">%&gt;%</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lucro)) <span class="sc">%&gt;%</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">&quot;pos&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="st">&quot;Hair$&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Filme&quot;</span> <span class="ot">=</span> titulo, <span class="st">&quot;Lucro&quot;</span> <span class="ot">=</span> lucro, <span class="st">&quot;Posição&quot;</span> <span class="ot">=</span> pos) <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Tabela 10 - Posição do filme </span><span class="sc">\&quot;</span><span class="st">Hair</span><span class="sc">\&quot;</span><span class="st"> no ranking de lucros obtidos pelos filmes&quot;</span>, <span class="at">align =</span> <span class="st">&quot;ccc&quot;</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>posicao_lucro_hair</span></code></pre></div>
<table>
<caption>
Tabela 10 - Posição do filme “Hair” no ranking de lucros obtidos pelos filmes
</caption>
<thead>
<tr>
<th style="text-align:center;">
Filme
</th>
<th style="text-align:center;">
Lucro
</th>
<th style="text-align:center;">
Posição
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Hair
</td>
<td style="text-align:center;">
4313606
</td>
<td style="text-align:center;">
4112
</td>
</tr>
</tbody>
</table>
<div style="text-align: justify">
<p><strong>c) Em que dia esse filme foi lançado? E dia da semana? Algum outro filme foi lançado no mesmo dia? Quantos anos você tinha nesse dia?</strong></p>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data de lançamento do filme hair</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>data_lancamento_hair <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="at">pattern =</span> <span class="st">&quot;Hair$&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">data_lancamento =</span> <span class="fu">as.Date</span>(<span class="fu">ymd</span>(data_lancamento))) </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>data_lancamento_hair<span class="sc">$</span>data_lancamento <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(data_lancamento_hair<span class="sc">$</span>data_lancamento, <span class="st">&quot;%Y-%m-%d&quot;</span>), <span class="st">&quot;%d/%m/%Y&quot;</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Outros filmes que foram lançados no mesmo dia</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>outros_filmes_lancados <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="at">pattern =</span> <span class="st">&quot;Hair$&quot;</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(data_lancamento, <span class="at">pattern =</span> <span class="st">&quot;1979-05-16&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(titulo)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando a minha idade quando o filme foi lançado</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>minha_idade <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="at">pattern =</span> <span class="st">&quot;Hair$&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data_lancamento =</span> <span class="fu">as.Date</span>(<span class="fu">ymd</span>(data_lancamento))) <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">minha_idade =</span> <span class="fu">as.period</span>(data_lancamento <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="fu">dmy</span>(<span class="st">&quot;05 nov 1997&quot;</span>))) <span class="sc">/</span> <span class="fu">years</span>(<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minha_idade =</span> <span class="fu">round</span>(minha_idade, <span class="dv">0</span>))</span></code></pre></div>
<div style="text-align: justify">
<p>“Hair” foi lançado em 16/05/1979, mesmo dia em que estreiou o filme “Donna tra cane e lupo”. Como nasci em 5 de novembro de 1997, eu tinha -18 anos de idade nesta data.</p>
<p><strong>d) Faça um gráfico representando a distribuição da nota atribuída a esse filme por idade (base <code>imdb_avaliacoes</code>).</strong></p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carregando os pacotes que irei utilizar para elaborar este gráfico:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecionando os valores das variáveis correspondentes às notas médias por</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># faixa etária</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>notas <span class="ot">&lt;-</span> imdb_completa <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(imdb_avaliacoes, <span class="at">by =</span> <span class="st">&quot;id_filme&quot;</span>, <span class="at">copy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(titulo, <span class="at">pattern =</span> <span class="st">&quot;Hair$&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    nota_media_idade_0_18, nota_media_idade_18_30,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    nota_media_idade_30_45, nota_media_idade_45_mais</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nota_media =</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(nota_media_idade_0_18, nota_media_idade_18_30, nota_media_idade_30_45, nota_media_idade_45_mais))) <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>()</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Elaborando gráfico sobre as notas médias das avaliações do filme &quot;Hair&quot; por</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># faixa etária</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>faixa_etaria <span class="ot">&lt;-</span> <span class="fu">list</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">c</span>(</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;0 a 18 anos&quot;</span>, <span class="st">&quot;18 a 30 anos&quot;</span>, <span class="st">&quot;30 a 45 anos&quot;</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;45 anos ou mais&quot;</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(faixa_etaria) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rowid&quot;</span>, <span class="st">&quot;faixa_etaria&quot;</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>faixa_etaria <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(faixa_etaria)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico das avaliações por idade</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>grafico_avaliacoes_idade <span class="ot">&lt;-</span> notas <span class="sc">%&gt;%</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(faixa_etaria, <span class="at">by =</span> <span class="st">&quot;rowid&quot;</span>, <span class="at">copy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nota_media, faixa_etaria) <span class="sc">%&gt;%</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> faixa_etaria, <span class="at">y =</span> nota_media, <span class="at">fill =</span> faixa_etaria)) <span class="sc">+</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> nota_media), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>() <span class="sc">+</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Figura 1 - Médias das notas dadas ao filme </span><span class="sc">\&quot;</span><span class="st">Hair</span><span class="sc">\&quot;</span><span class="st"> por faixa etária&quot;</span>,</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Nota média das avaliações&quot;</span>,</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Faixa etária&quot;</span>,</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Fonte: IMDB&quot;</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: stat</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>grafico_avaliacoes_idade</span></code></pre></div>
<p><img src="RelatórioFinalMariaElisa_files/figure-html/Pergunta%205,%20letra%20D-1.png" /><!-- --></p>
</div><!-- /.entry-content -->
</article>
</div><!-- /#main -->



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
